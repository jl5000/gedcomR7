# Generated by roxytest: do not edit by hand!

# File R/cls_record.R: @tests

test_that("Function class_record() @ L26", {
  skip_if_offline(host = "gedcom.io")
  ged_raw <- readLines("https://gedcom.io/testfiles/gedcom70/maximal70.ged")
  ged_parsed <- read_gedcom("https://gedcom.io/testfiles/gedcom70/maximal70.ged")
  
  for(rec_type in names(ged_parsed@xref_prefixes)){
    xrefs <- ged_parsed@c_xrefs[[rec_type]]
    
    for(xref in xrefs){
      rec_raw <- S7::prop(ged_parsed, rec_type)[[xref]]
      # Remove extension tags
      rec_raw <- rec_raw[grepl(anchor_it(reg_tag()), parse_line_tag(rec_raw))]
      rec_parsed <- suppressWarnings(pull_record(ged_parsed, xref))
      
      expect_equal(rec_parsed@c_as_ged, rec_raw)
    }
  }
})

